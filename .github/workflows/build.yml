name: Build

on:
  push:
    branches: ["master"]
    tags:
  pull_request:

jobs:
  test:
    runs-on: ubuntu-latest
    strategy:
      matrix:
        cluster:
          - external
          - raspberry
    steps:
      - name: Checkout code
        uses: actions/checkout@v5
      - name: Setup Flux CLI
        uses: fluxcd/flux2/action@v2.2.2
      - uses: allenporter/flux-local/action/test@7.10.1
        with:
          path: ${{ matrix.cluster }}
          enable-helm: true
